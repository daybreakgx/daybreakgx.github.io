---
layout: post
title: "C++ primer读书笔记（八）--- Containers "
categories: c++
tags: c++
---

* content
{:toc}

> 顺序容器(sequential container)为程序员提供了控制元素存储和访问顺序的能力。元素在顺序容器中的顺序与其加入容器时的位置相对应。

> 关联容器中元素的位置由元素相关联的关键字值决定。

> 所有容器类都共享公共的接口，不同容器按不同方式对其扩展。这个公共接口使容器的学习更加容易---基于某种容器所学习的内容也都适用于其他容器。每种容器都提供了不同的性能和功能的权衡。

##### 容器公共特性




##### 顺序容器

###### 顺序容器类型

* 下表列出了标准库中的顺序容器，所有顺序容器都提供了快速顺序访问元素的能力。但是这些容器在以下方面都有不同的性能折中。
  + 向容器中添加或从容器中删除元素的代价
  + 非顺序访问容器中元素的代价

  类型|描述|添加删除元素操作|元素访问方式|尾部插入删除元素|头部插入删除元素|其他位置插入删除元素
  array| 固定大小数组 | X | 快速随机访问| X | X | X
  vector| 可变大小数组 | 支持 | 快速随机访问 | 快速 | 可能很慢 | 可能很慢 
  string| 与vector类似的容器，专门用于保存字符 | 支持 | 快速随机访问 | 快速 | 可能很慢 | 可能很慢
  list| 双向链表 | 支持 | 双向顺序访问 | 快速 | 快速 | 快速
  forward_list| 单向链表 | 支持 | 单向顺序访问 | 快速 | 快速 | 快速
  deque| 双端队列 | 支持 | 快速随机访问 | 快速 | 快速 | 可能很慢

  > 现代C++程序应该使用标准库容器，而不是更原始的数据结构，如内置数组。

* 顺序容器选择原则
  + 除非你有很好的理由选择其他容器，否则应使用vector。
  + 如果你的程序有很多小的元素，且空间的额外开销很重要，则不要使用list或forward_list。
  + 如果程序要求随机访问元素，应使用vector或deque。
  + 如果程序要求在容器的中间位置插入或删除元素，应使用list或forward_list。
  + 如果程序要求在头尾位置插入或删除元素，但不会在中间位置进行插入或删除操作，则使用deque。
  + 如果程序只有在读取输入时才需要在容器的中间位置插入元素，随后需要随机访问元素
    - 首先，确认是否真的需要在容器中间插入元素。当处理输入数据时，通常可以很容易的向vector追加数据，然后调用标准库的sort函数来重排容器中的元素，从而避免在中间位置添加元素。
    - 如果必须在中间位置插入元素，考虑在输入时使用list，一旦输入完成，将list中的内容拷贝到一个vector中。

  > 如果程序中既需要随机访问元素，又要在容器中间位置插入元素，容器选择取决于 在list或forward_list中访问元素与vector或deque中插入/删除元素的相对性能。一般来说，应用中占主导地位的操作决定了容器类型的选择。在此情况下，对两种容器分别测试应用性能可能就是必须的了。

  > 如果不确定使用哪种容器，可以在程序中只使用vector和list公共的操作：使用迭代器，不使用下标操作，避免随机访问。这样，在必要时选择使用vector或list都很方便。



